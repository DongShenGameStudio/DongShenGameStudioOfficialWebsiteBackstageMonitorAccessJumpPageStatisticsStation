<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>后台访问跳检查点</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/png" href="favicon.png">
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}
        body{background:linear-gradient(135deg,#1a2a6c,#b21f1f,#fdbb2d);color:#fff;min-height:100vh;overflow-x:hidden;padding:20px;display:flex;flex-direction:column}
        .container{width:100%;max-width:1400px;text-align:center;padding:20px;margin:0 auto;display:flex;flex-direction:column;min-height:100vh}
        .main-content{flex:1;display:flex;flex-direction:column;justify-content:center;padding:20px 0}
        .header{margin-bottom:40px}.header h1{font-size:2.5rem;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,0.3)}
        .header p{font-size:1.2rem;opacity:0.9}.buttons{display:flex;flex-direction:column;gap:20px;margin-bottom:40px}
        .btn{padding:18px 30px;border:none;border-radius:50px;font-size:1.2rem;font-weight:bold;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:10px;box-shadow:0 4px 15px rgba(0,0,0,0.2)}
        .btn-primary{background:linear-gradient(to right,#4776E6,#8E54E9);color:white}
        .btn-secondary{background:linear-gradient(to right,#FF512F,#DD2476);color:white}
        .btn:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,0.3)}
        .btn:active{transform:translateY(1px)}.info-section{margin-top:auto;padding:20px 0}
        .info-panel{background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);border-radius:20px;padding:25px;max-height:400px;overflow-y:auto;box-shadow:0 8px 32px rgba(0,0,0,0.2);border:1px solid rgba(255,255,255,0.18)}
        .stats-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:10px 15px;background:rgba(0,0,0,0.2);border-radius:10px}
        .stat-item{display:flex;flex-direction:column;align-items:center}.stat-value{font-size:1.5rem;font-weight:bold}
        .stat-label{font-size:0.9rem;opacity:0.8}.info-panel h2{margin-bottom:20px;font-size:1.8rem;display:flex;align-items:center;justify-content:center;gap:10px}
        .access-list{width:100%;border-collapse:collapse}.access-list th,.access-list td{padding:12px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.1);white-space:nowrap}
        .access-list th{background-color:rgba(0,0,0,0.2);position:sticky;top:0}.access-list tr:hover{background-color:rgba(255,255,255,0.05)}
        .swipe-indicator{margin-top:20px;display:flex;flex-direction:column;align-items:center;opacity:0.7}
        .swipe-indicator i{font-size:2rem;animation:bounce 2s infinite}@keyframes bounce{0%,20%,50%,80%,100%{transform:translateY(0)}40%{transform:translateY(-20px)}60%{transform:translateY(-10px)}}
        .footer{margin-top:30px;opacity:0.7;font-size:0.9rem;padding:20px 0}.no-select{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
        #devtools-warning{position:fixed;top:0;left:0;width:100%;background:#b21f1f;color:white;padding:15px;text-align:center;z-index:10000;display:none;font-weight:bold}
        .clear-btn{margin-top:15px;padding:8px 15px;background:rgba(255,255,255,0.2);border:none;border-radius:5px;color:white;cursor:pointer;transition:background .3s}
        .clear-btn:hover{background:rgba(255,255,255,0.3)}.pc-redirect-notice{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:10000;display:none}
        .pc-redirect-notice p{font-size:1.5rem;margin-bottom:20px;text-align:center;padding:0 20px}
        .ip-type-badge{font-size:0.7em;padding:2px 6px;border-radius:4px;background:rgba(255,255,255,0.2);margin-left:5px}
        .ip-toggle-container{display:flex;justify-content:flex-end;margin-bottom:10px;gap:10px}
        .ip-toggle-btn{padding:5px 10px;background:rgba(255,255,255,0.2);border:none;border-radius:4px;color:white;cursor:pointer;font-size:0.8rem}
        .ip-toggle-btn.active{background:rgba(255,255,255,0.4)}.loading-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:flex;justify-content:center;align-items:center;z-index:9999;flex-direction:column}
        .loading-spinner{width:50px;height:50px;border:5px solid rgba(255,255,255,0.3);border-radius:50%;border-top-color:#fff;animation:spin 1s ease-in-out infinite}
        @keyframes spin{to{transform:rotate(360deg)}}.api-status{font-size:0.8rem;opacity:0.7;margin-top:10px}
        .countdown-timer{margin-top:15px;font-size:1rem;color:#fdbb2d}.hidden{display:none !important}
        .operator-badge{font-size:0.7em;padding:2px 6px;border-radius:4px;background:rgba(0,255,255,0.2);margin-left:5px}
        .coordinates-badge{font-size:0.7em;padding:2px 6px;border-radius:4px;background:rgba(255,0,255,0.2);margin-left:5px}
        .poi-badge{font-size:0.7em;padding:2px 6px;border-radius:4px;background:rgba(255,255,0,0.2);margin-left:5px}
        .road-badge{font-size:0.7em;padding:2px 6px;border-radius:4px;background:rgba(0,255,0,0.2);margin-left:5px}
        .address-badge{font-size:0.7em;padding:2px 6px;border-radius:4px;background:rgba(255,0,0,0.2);margin-left:5px}
        /* ====== 终端弹窗样式（黑底绿字仿CMD） ====== */
        #term-modal{position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:20000;display:none;align-items:center;justify-content:center}
        #term-box{width:90%;max-width:700px;background:#000;border:1px solid #0f0;border-radius:6px;display:flex;flex-direction:column;overflow:hidden}
        #term-header{background:#000;display:flex;align-items:center;justify-content:space-between;padding:6px 10px;border-bottom:1px solid #0f0}
        #term-icon{width:16px;height:16px;background:url(cmd.png) center/cover no-repeat}
        #term-title{color:#0f0;font-size:14px;margin-left:8px}
        #term-close{background:transparent;border:none;color:#0f0;font-size:18px;cursor:pointer}
        #term-body{padding:10px;font-family:'Courier New',Courier,monospace;font-size:14px;color:#0f0;white-space:pre-wrap;outline:none;min-height:120px;max-height:300px;overflow-y:auto}
        #term-input{display:flex;align-items:center}
        #term-prompt{color:#0f0;margin-right:6px}
        #term-cmd{background:transparent;border:none;color:#0f0;outline:none;font-family:'Courier New',Courier,monospace;font-size:14px;flex:1}
    </style>
    <!-- Umami 网站统计跟踪代码 -->
    <script defer src="https://cloud.umami.is/script.js" data-website-id="fd54c165-2845-4dcb-81a2-96bf7a7b0387"></script>
</head>
<body class="no-select">
    <div id="devtools-warning"><i class="fas fa-exclamation-triangle"></i> 检测到开发者工具已打开，请关闭以继续使用</div>
    <div class="pc-redirect-notice" id="pc-redirect-notice">
        <p>检测到桌面设备访问，正在跳转到错误页面...</p>
        <div class="btn btn-primary"><i class="fas fa-sync-alt fa-spin"></i> 跳转中</div>
    </div>
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
        <p style="margin-top:20px">正在获取IP和位置信息...</p>
        <p class="api-status" id="api-status">正在尝试API: ipinfo.io</p>
        <p class="countdown-timer" id="countdown-timer">16秒后自动隐藏</p>
    </div>

    <div class="container">
        <div class="main-content">
            <div class="header">
                <h1><i class="fas fa-shield-alt"></i> 东神游戏工作室官网监控后台进入入口</h1>
                <p>检查点 - 人机验证</p>
            </div>
            <div class="buttons">
                <button class="btn btn-primary" id="main-btn"><i class="fas fa-sign-in-alt"></i> 确定进入网站监控后台</button>
                <button class="btn btn-secondary" id="power-btn"><i class="fas fa-power-off"></i> Power=0</button>
                <button class="btn btn-secondary" id="power-btn"><i class="fas fa-power-off"></i> Power=1</button>
                <button class="btn btn-secondary" id="power-btn"><i class="fas fa-power-off"></i> Power=2</button>
                <button class="btn btn-secondary" id="power-btn"><i class="fas fa-power-off"></i> Online=0</button>
                <button class="btn btn-secondary" id="power-btn"><i class="fas fa-power-off"></i> Online=1</button>
                <button class="btn btn-secondary" id="power-btn"><i class="fas fa-power-off"></i> Online=2</button>
            </div>
            <div class="swipe-indicator">
                <p>向上滑动查看所有访问记录</p>
                <i class="fas fa-chevron-up"></i>
            </div>
        </div>

        <div class="info-section">
            <div class="info-panel">
                <div class="stats-bar">
                    <div class="stat-item"><span class="stat-value" id="total-visits">0</span><span class="stat-label">总访问次数</span></div>
                    <div class="stat-item"><span class="stat-value" id="unique-devices">0</span><span class="stat-label">唯一设备</span></div>
                </div>
                <div class="ip-toggle-container">
                    <button class="ip-toggle-btn active" id="ipv4-toggle">IPv4</button>
                    <button class="ip-toggle-btn" id="ipv6-toggle">IPv6</button>
                </div>
                <h2><i class="fas fa-history"></i> 访问记录</h2>
                <table class="access-list">
                    <thead>
                        <tr>
                            <th>时间</th><th>设备类型</th><th>浏览器</th><th>操作系统</th>
                            <th>IP 地址</th><th>运营商</th><th>经纬度</th>
                            <th>附近机构</th><th>附近道路</th><th>所在地址</th>
                        </tr>
                    </thead>
                    <tbody id="access-records"></tbody>
                </table>
                <button class="clear-btn" id="clear-btn">eDEX系统网站服务器PC_CMD终端命令行提示符-890012</button>
            </div>
            <div class="copyright">©2025 • 东神团队 | 东神工作室官网 | 东神工作室 | 东神服务器 |  东神工作室与东神服务器有权保留一切</div>
            <div class="footer">本网站由东神团队维护，东神团队有权保留所有权利！</div>
        </div>
    </div>

    <!-- 终端弹窗 -->
    <div id="term-modal">
        <div id="term-box">
            <div id="term-header">
                <div style="display:flex;align-items:center">
                    <div id="term-icon"></div>
                    <span id="term-title">命令提示符-eDEX系统服务器_管理员</span>
                </div>
                <button id="term-close">&times;</button>
            </div>
            <div id="term-body">Dongshenteam eDEX 〔版本 02.8.12778.1103〕
(C) Dongshenteam Corporation。 保留所有权利。
                <div id="term-content">C:eDEX\System128&gt;</div>
                <div id="term-input">
                    <span id="term-prompt">C:eDEX\System128&gt;</span>
                    <input id="term-cmd" type="text" spellcheck="false" autocomplete="off">
                </div>
            </div>
        </div>
    </div>

    <!-- ====== 所有 DOM 生成完再执行 ====== -->
    <script>
    // 同意弹窗控制（顺序已修）
    document.addEventListener('DOMContentLoaded', async () => {
        /* 1. 先拉云端数据（DOM 已生成） */
        try {
            const remote = await fetch('https://dongshengamestudio.github.io/CheckpointsDataBase//logs.json')
                             .then(r => r.json())
                             .catch(() => []);
            localStorage.setItem('accessRecords', JSON.stringify(remote));
        } catch {}

        /* 2. 同意弹窗逻辑 */
        const overlay = document.getElementById('consent-overlay');
        const agree   = document.getElementById('consent-agree');
        const decline = document.getElementById('consent-decline');

        if (localStorage.getItem('consent-given') === 'yes') {
            overlay.style.display = 'none';
            initPage();
            return;
        }

        agree.addEventListener('click', () => {
            localStorage.setItem('consent-given', 'yes');
            overlay.style.display = 'none';
            initPage();
        });

        decline.addEventListener('click', () => {
            location.href = 'https://dongshengamestudio.github.io/DongShenGameStudioOfficialWebsiteBackstageMonitorAccessJumpPageStatisticsStation/';
        });
    });

    function initPage() {
        try {
            if (checkIfPC()) {
                document.getElementById('loading-overlay').style.display = 'none';
                return;
            }
            checkDevTools();
            displayAccessRecords();
            updateStats();
            saveAccessRecord();
            setInterval(checkDevTools, 500);
            setInterval(checkIfPC, 1000);
        } catch (e) {
            console.error('initPage 错误：', e);
        }
    }

    /* ============== 工具函数 ============== */
    function getBrowserInfo() {
        const ua = navigator.userAgent;
        if (ua.includes('Chrome') && !ua.includes('Edg')) return 'Chrome';
        if (ua.includes('Firefox')) return 'Firefox';
        if (ua.includes('Safari') && !ua.includes('Chrome')) return 'Safari';
        if (ua.includes('Edg')) return 'Edge';
        if (ua.includes('MSIE') || ua.includes('Trident')) return 'IE';
        if (ua.includes('Opera') || ua.includes('OPR')) return 'Opera';
        return '未知浏览器';
    }
    function getOSInfo() {
        const ua = navigator.userAgent;
        if (ua.includes('Android')) return 'Android';
        if (ua.includes('iPhone') || ua.includes('iPad')) return 'iOS';
        if (ua.includes('Win')) return 'Windows';
        if (ua.includes('Mac')) return 'MacOS';
        if (ua.includes('Linux')) return 'Linux';
        return '未知操作系统';
    }
    function getDeviceType() {
        const ua = navigator.userAgent;
        if (/Mobi|Android/i.test(ua)) return '移动设备';
        if (/Tablet|iPad/i.test(ua)) return '平板设备';
        return '桌面设备';
    }
    function getDeviceId() {
        let id = localStorage.getItem('deviceId');
        if (!id) { id = 'v_' + Math.random().toString(36).slice(2, 7); localStorage.setItem('deviceId', id); }
        return id;
    }

    /* ============== IP 双栈 ============== */
    async function getIPAddress() {
        const ipv4Url = 'https://ipinfo.io/json';
        const ipv6Url = 'https://api6.ipify.org?format=json';
        let ipv4 = '未获取到', ipv6 = '未获取到';
        try { const r = await fetch(ipv4Url); ipv4 = (await r.json()).ip || ipv4; } catch {}
        try { const r = await fetch(ipv6Url); ipv6 = (await r.json()).ip || ipv6; } catch {}
        return { ipv4, ipv6 };
    }

    /* ============== 定位（GPS→IP） ============== */
    async function getRealLocation() {
        const gps = await new Promise(res => {
            if (!navigator.geolocation) return res(null);
            navigator.geolocation.getCurrentPosition(
                p => res({ lat: p.coords.latitude, lng: p.coords.longitude }),
                () => res(null),
                { enableHighAccuracy: true, timeout: 8000 }
            );
        });
        if (gps) return gps;
        try {
            const ip = await (await fetch('https://ipinfo.io/json')).json();
            const [lat, lng] = ip.loc.split(',').map(Number);
            return { lat, lng };
        } catch { return null; }
    }
    async function getCoordinates() {
        const loc = await getRealLocation();
        return loc ? `${loc.lat},${loc.lng}` : '未知';
    }

    /* ============== 高德逆地理 ============== */
    async function getOperatorInfo() {
        try { return (await (await fetch('https://ipinfo.io/json')).json()).org || '未知'; } catch { return '未知'; }
    }
    async function getNearbyPOI(loc) {
        if (loc === '未知') return '未知';
        const [lat, lng] = loc.split(',');
        try {
            const u = `https://restapi.amap.com/v3/geocode/regeo?output=json&location=${lng},${lat}&key=bda831a9a224d37e982ff680fbbeeb43&radius=1000&extensions=all`;
            const d = await (await fetch(u)).json();
            return (d.regeocode?.pois?.[0]?.name) || '未知';
        } catch { return '未知'; }
    }
    async function getNearbyRoads(loc) {
        if (loc === '未知') return '未知';
        const [lat, lng] = loc.split(',');
        try {
            const u = `https://restapi.amap.com/v3/geocode/regeo?output=json&location=${lng},${lat}&key=bda831a9a224d37e982ff680fbbeeb43&radius=1000&extensions=all`;
            const d = await (await fetch(u)).json();
            return (d.regeocode?.roads?.[0]?.name) || '未知';
        } catch { return '未知'; }
    }
    async function getAddress(loc) {
        if (loc === '未知') return '未知';
        const [lat, lng] = loc.split(',');
        try {
            const u = `https://restapi.amap.com/v3/geocode/regeo?output=json&location=${lng},${lat}&key=bda831a9a224d37e982ff680fbbeeb43&radius=1000`;
            const d = await (await fetch(u)).json();
            if (d.status === '1') return d.regeocode.formatted_address || '未知';
        } catch {}
        return '未知';
    }

    /* ============== 记录存取 ============== */
    function updateStats() {
        const records = JSON.parse(localStorage.getItem('accessRecords') || '[]');
        document.getElementById('total-visits').textContent = records.length;
        document.getElementById('unique-devices').textContent = new Set(records.map(r => r.deviceId)).size;
    }
    function displayAccessRecords() {
        const records = JSON.parse(localStorage.getItem('accessRecords') || '[]');
        const tbody = document.getElementById('access-records');
        const showIPv4 = document.getElementById('ipv4-toggle').classList.contains('active');
        tbody.innerHTML = '';
        if (!records.length) { tbody.innerHTML = '<tr><td colspan="10" style="text-align:center">暂无访问记录</td></tr>'; return; }
        records.forEach(r => {
            const displayIP = showIPv4 ? r.ipv4 : r.ipv6;
            const ipType = displayIP.includes('.') ? 'IPv4' : (displayIP.includes(':') ? 'IPv6' : '未知');
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${r.time}</td>
                <td>${r.device} <span class="device-id-badge">${r.deviceId}</span></td>
                <td>${r.browser}</td><td>${r.os}</td>
                <td>${displayIP} <span class="ip-type-badge">${ipType}</span></td>
                <td>${r.operator} <span class="operator-badge">运营商</span></td>
                <td>${r.coordinates} <span class="coordinates-badge">经纬度</span></td>
                <td>${r.nearbyPOI} <span class="poi-badge">附近机构</span></td>
                <td>${r.nearbyRoads} <span class="road-badge">附近道路</span></td>
                <td>${r.address} <span class="address-badge">所在地址</span></td>`;
            tbody.appendChild(tr);
        });
    }

    /* ============== 终端弹窗逻辑 ============== */
    const termModal = document.getElementById('term-modal');
    const termClose = document.getElementById('term-close');
    const termCmd   = document.getElementById('term-cmd');
    const termContent = document.getElementById('term-content');
    const termPrompt = document.getElementById('term-prompt');

    document.getElementById('clear-btn').addEventListener('click', () => {
        termModal.style.display = 'flex';
        termCmd.focus();
        termContent.textContent = 'C:eDEX\\System128>';
    });
    termClose.addEventListener('click', () => {
        termModal.style.display = 'none';
        termCmd.value = '';
    });
    termModal.addEventListener('click', (e) => {
        if (e.target === termModal) { termClose.click(); }
    });

    termCmd.addEventListener('keydown', (e) => {
        if (e.key !== 'Enter') return;
        e.preventDefault();
        const cmd = termCmd.value.trim();
        termContent.textContent += '\nC:eDEX\\System128>' + cmd;
        if (cmd === 'clear WebJl D:/eDEX-UI/DongShenGameStudio/Jl/') {
            localStorage.removeItem('accessRecords');
            displayAccessRecords();
            updateStats();
            termContent.textContent += '\n[成功] 所有访问记录已清空。';
        } else if (cmd === 'clear Web-cmd_PiMu' || cmd === 'cls') {
            termContent.textContent = 'C:eDEX\\System128>';
        } else if (cmd === 'help' || cmd === '?') {
            termContent.textContent += `
 可用命令：
  clear WebJl D:/eDEX-UI/DongShenGameStudio/Jl/   清空访问记录
  clear Web-cmd_PiMu  或  cls                     清屏
  help  或  ?                                       显示本帮助
  exit  或  quit                                    关闭终端`;
        } else if (cmd === 'exit' || cmd === 'quit') {
            termClose.click();
        } else {
            termContent.textContent += '\n[语法错误，请检查该"神"命令是否存在于注册表内。]';
        }
        termCmd.value = '';
        termContent.scrollTop = termContent.scrollHeight;
    });

    /* ============== 按钮事件 ============== */
    document.getElementById('main-btn').addEventListener('click', () => location.href = 'https://us.umami.is/websites/fd54c165-2845-4dcb-81a2-96bf7a7b0387');
    document.getElementById('power-btn').addEventListener('click', () => location.href = 'https://dongshengamestudio.github.io/DongShenGameStudio/WebsiteBackstageMonitorAccessStation/');
    document.getElementById('ipv4-toggle').addEventListener('click', function () {
        this.classList.add('active'); document.getElementById('ipv6-toggle').classList.remove('active'); displayAccessRecords();
    });
    document.getElementById('ipv6-toggle').addEventListener('click', function () {
        this.classList.add('active'); document.getElementById('ipv4-toggle').classList.remove('active'); displayAccessRecords();
    });

    /* ============== 主流程 ============== */
    async function saveAccessRecord() {
        if (getDeviceType() === '桌面设备') { document.getElementById('loading-overlay').classList.add('hidden'); clearInterval(countdownInterval); return; }
        try {
            const ipData = await getIPAddress();
            const operator = await getOperatorInfo();
            const coordinates = await getCoordinates();
            const nearbyPOI = await getNearbyPOI(coordinates);
            const nearbyRoads = await getNearbyRoads(coordinates);
            const address = await getAddress(coordinates);
            const now = new Date();
            const record = {
                time: now.toLocaleString('zh-CN'),
                device: getDeviceType(), browser: getBrowserInfo(), os: getOSInfo(),
                ipv4: ipData.ipv4, ipv6: ipData.ipv6, operator: operator,
                coordinates, nearbyPOI, nearbyRoads, address, deviceId: getDeviceId()
            };
            let records = JSON.parse(localStorage.getItem('accessRecords') || '[]');
            records.unshift(record);
            if (records.length > 251) records = records.slice(0, 251);
            localStorage.setItem('accessRecords', JSON.stringify(records));
            displayAccessRecords(); updateStats();
        } catch (e) { console.error(e) } finally {
            document.getElementById('loading-overlay').classList.add('hidden');
            clearInterval(countdownInterval);
        }
    }
    function checkDevTools() {
        const dev = window.outerWidth - window.innerWidth > 100 || window.outerHeight - window.innerHeight > 100;
        document.getElementById('devtools-warning').style.display = dev ? 'block' : 'none';
    }
    function checkIfPC() {
        if (getDeviceType() === '桌面设备') {
            document.getElementById('pc-redirect-notice').style.display = 'flex';
            setTimeout(() => location.href = 'https://dongshengamestudio.github.io/error30081690014443201/', 2000);
            return true;
        }
        return false;
    }
    let countdownInterval;
    function startCountdown() {
        let s = 16; const el = document.getElementById('countdown-timer');
        countdownInterval = setInterval(() => {
            s--; el.textContent = `${s}秒后自动隐藏`;
            if (s <= 0) { clearInterval(countdownInterval); document.getElementById('loading-overlay').classList.add('hidden'); }
        }, 1000);
    }

    /* ============== 同意弹窗（顺序已修） ============== */
    document.addEventListener('DOMContentLoaded', async () => {
        /* 先拉云端数据 */
        try {
            const remote = await fetch('https://dongshengamestudio.github.io/CheckpointsDataBase//logs.json')
                             .then(r => r.json())
                             .catch(() => []);
            localStorage.setItem('accessRecords', JSON.stringify(remote));
        } catch {}

        /* 同意弹窗逻辑 */
        const overlay = document.getElementById('consent-overlay');
        const agree   = document.getElementById('consent-agree');
        const decline = document.getElementById('consent-decline');

        if (localStorage.getItem('consent-given') === 'yes') {
            overlay.style.display = 'none';
            initPage();
            return;
        }

        agree.addEventListener('click', () => {
            localStorage.setItem('consent-given', 'yes');
            overlay.style.display = 'none';
            initPage();
        });

        decline.addEventListener('click', () => {
            location.href = 'https://dongshengamestudio.github.io/DongShenGameStudioOfficialWebsiteBackstageMonitorAccessJumpPageStatisticsStation/';
        });
    });

    /* ============== 初始化函数包 ============== */
    function initPage() {
        try {
            if (checkIfPC()) {
                document.getElementById('loading-overlay').style.display = 'none';
                return;
            }
            checkDevTools();
            displayAccessRecords();
            updateStats();
            saveAccessRecord();
            setInterval(checkDevTools, 500);
            setInterval(checkIfPC, 1000);
        } catch (e) {
            console.error('initPage 错误：', e);
        }
    }
    </script>

    <!-- 同意弹窗 DOM -->
    <div id="consent-overlay" style="position:fixed;inset:0;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center;z-index:99999;font-family:'Segoe UI',sans-serif">
        <div style="background:#1a2a6c;border:1px solid rgba(255,255,255,.2);border-radius:15px;padding:30px 40px;max-width:90%;width:400px;text-align:center;box-shadow:0 0 20px rgba(0,0,0,.5)">
            <h2 style="margin-bottom:15px">隐私提示</h2>
            <p style="margin-bottom:20px;font-size:.95rem;line-height:1.5">
                本站为<strong>内部监控入口</strong>，仅用于家庭记录。<br>
                若您继续访问，我们将收集您的：<br>
                • IP 地址与所在地址、经纬度、附近机构<br>
                • 设备类型与型号、浏览器、操作系统<br>
                • 网络运营商、附近道路、进入时间<br><br>
                数据保存在 eDEX 系统服务器，数据将会上传与共享。
            </p>
            <div style="display:flex;gap:15px;justify-content:center">
                <button id="consent-agree" class="btn btn-primary">同意并进入</button>
                <button id="consent-decline" class="btn btn-secondary">拒绝并离开</button>
            </div>
        </div>
    </div>
</body>
</html>